---
title: "Youtube Trending analysis"
author: "Ullas Srivastava,Diwei Zhu,Valeriya Gorelova,Wandi Zhang"
date: "12/8/2020"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,cache = T)
```


```{r message=FALSE, warning=FALSE}
library(quanteda)
library(tidyr)
library(tidytext)
library(wordcloud)
library(tm)
library(tidyverse)
library(ggplot2)
```



# PART 1: Exploratory Data Analysis & Text Analytics

```{r}
original_data <- read.csv("USvideos.csv")
```

## 1. How many complaints have been generated?

```{r}
data<-original_data
dim(data)
colnames(data)
if(1){
  temp<-list("category_id","views","likes","dislikes","comment_count","comments_disabled","ratings_disabled","video_error_or_removed")

  for ( i in temp){
  print(paste("========",i,"========="))
  if(is.character(data[[i]])){
 print(table(data[[i]]))
  }else
  {
    print(summary(data[[i]]))
  }
  }
}


```

## data processing

```{r}
#formatting
data$trending_date<-as.Date(data$trending_date, "%y.%d.%m")
data$publish_time<-as.Date(data$publish_time)
data[,"thumbnail_link"]<-NULL
data<-subset(data,!(data$video_id=="kZete48ZtsY"&data$video_error_or_removed=="True"))

#aggregate
data1<-aggregate(data[,c("video_id")],
                 by=list(data$video_id,data$title,data$channel_title,data$category_id,data$publish_time,data$tags,data$comments_disabled,data$ratings_disabled,data$video_error_or_removed,data$description,data$channel_title),
                 FUN = length)
colnames(data1)<-c("video_id","title","channel_title","category_id","publish_time","tags","comments_disabled","ratings_disabled","video_error_or_removed","description","channel_title","count")
data10<-aggregate(data$video_id,by=list(data$video_id),length)
colnames(data10)<-c("video_id","trending_count")

process_list<- list("description","tags","title")
for(i in 1:nrow(data10)){
  ifelse(i%%1000==0,print(paste(i," ",round(i/nrow(data10)*100,2),"%")),0)
  temp<-subset(data,data$video_id==data10[i,"video_id"])
  temp<-temp[order(temp$trending_date,decreasing = T),]
  data10[i,"first_trending"]<-min(temp$trending_date)
  data10[i,"last_trending"]<-max(temp$trending_date)
  
  data10[i,"title"]<-temp[1,"title"]
  data10[i,"title_change_count"]<-length(unique(temp$title))
  
  data10[i,"tags"]<-temp[1,"tags"]
  data10[i,"tag_change_count"]<-length(unique(temp$tags))
  
  data10[i,"description"]<-temp[1,"description"]
  data10[i,"des_change_count"]<-length(unique(temp$description))
  
  data10[i,"category_id"]<-temp[1,"category_id"]
  data10[i,"cat_change_count"]<-length(unique(temp$category_id))
  
  data10[i,"channel_title"]<-temp[1,"channel_title"]
  data10[i,"chn_change_count"]<-length(unique(temp$channel_title))
  
  data10[i,"publish_time"]<-min(temp$publish_time)
  
  data10[i,"views"]<-temp[1,"views"]
  data10[i,"max_view"]<-max(temp$views)
  data10[i,"min_view"]<-min(temp$views)
  
  data10[i,"likes"]<-temp[1,"likes"]
  data10[i,"max_likes"]<-max(temp$likes)
  data10[i,"min_likes"]<-min(temp$likes)
  
  data10[i,"dislikes"]<-temp[1,"dislikes"]
  data10[i,"max_dislikes"]<-max(temp$dislikes)
  data10[i,"min_dislikes"]<-min(temp$dislikes)
  
  data10[i,"comment_count"]<-temp[1,"comment_count"]
  data10[i,"max_comments"]<-max(temp$comment_count)
  data10[i,"min_comments"]<-min(temp$comment_count)
  
  data10[i,"comments_disabled"]<-temp[1,"comments_disabled"]
  data10[i,"ratings_disabled"]<-temp[1,"ratings_disabled"]
  data10[i,"video_error_or_removed"]<-temp[1,"video_error_or_removed"]
  
  
}

data10$description<-str_replace_all(data10$description,"http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+","EXTERNALURL ")
data10$description<-str_replace_all(data10$description,"(\\\\r\\n|\\\\r|\\\\n)"," ")
data10$des_url_count<-unlist(lapply(data10$description,function(x){length(str_extract_all(x,"EXTERNALURL")[[1]])}))
data10$description<-str_replace_all(data10$description,"EXTERNALURL"," ")
for (j in process_list){
    data10[[paste(j,"P")]] <- gsub("'", "", data10[[j]]) # remove apostrophes
    data10[[paste(j,"P")]] <- gsub("[[:punct:]]", " ", data10[[j]])  # replace punctuation with space
    data10[[paste(j,"P")]] <- gsub("[[:cntrl:]]", " ", data10[[j]])  # replace control characters with space
    data10[[paste(j,"P")]] <- gsub("^[[:space:]]+", "", data10[[j]]) # remove whitespace at beginning of documents
    data10[[paste(j,"P")]] <- gsub("[[:space:]]+$", "", data10[[j]]) # remove whitespace at end of documents
    data10[[paste(j,"P")]] <- gsub("[^a-zA-Z -]", " ", data10[[j]]) # allows only letters
    data10[[paste(j,"P")]] <- tolower(data10[[j]]) 
  }
data10$trending_span = as.numeric(data10$last_trending-data10$first_trending)
data10$day_until_trending = as.numeric(data10$first_trending-data10$publish_time)
data10$like_rate=round(data10$likes/(data10$likes+data10$dislikes)*100,2)
data10$like_engage_rate=round((data10$likes+data10$dislikes)/data10$views*100,2)
data10$comment_engage_rate=round(data10$comment_count/data10$views*100,2)
data10$view_increment=ifelse(data10$trending_span>0,round((data10$max_likes-data10$min_likes)/data10$trending_span,2),0)
data10$engagement_score<-50*data10$comment_count/25000 +20*(data10$likes+data10$dislikes)/500000-5*data10$day_until_trending+10*data10$view_increment/250 +5*data10$views/50000000

cat_dict<-c("Film & Animation","Autos & Vehicles","Music","Pets & Animals","Sports","Short Movies","Travel & Events","Gaming","Videoblogging","People & Blogs","Comedy","Entertainment","News & Politics","Howto & Style","Education","Science & Technology","Nonprofits & Activism","Movies","Anime/Animation","Action/Adventure","Classics","Comedy","Documentary","Drama","Family","Foreign","Horror","Sci-Fi/Fantasy","Thriller","Shorts","Shows","Trailers")
names(cat_dict)<-c(1,2,10,15,17:44)

data10$category_name<-unlist(lapply(data10$category_id,function(x){
  return(cat_dict[[toString(x)]])
}))
```



```{r}
colnames(data10)
```




```{r date distribute} 
temp <- data10$first_trending
temp<-data.frame(temp)
temp$pub <-data10$publish_time
temp$diff<-data10$day_until_trending
temp$PUByearmonth<-format(temp$pub,"%Y-%m")
temp$TRDyearmonth<-format(temp$temp,"%Y-%m")

ggplot(data = temp[temp$PUByearmonth<"2017-10",],mapping = aes(x=PUByearmonth))+geom_bar()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("first publish date (before 2017-10)")
ggplot(data = temp[temp$PUByearmonth>="2017-10",],mapping = aes(x=PUByearmonth))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("first publish date (after 2017-10)(included)")
ggplot(data = temp,mapping = aes(x=TRDyearmonth))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("first trending date")
ggplot(data = data10,mapping = aes(x=trending_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many times on trending")
ggplot(data = data10,mapping = aes(x=trending_span))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days between first and last trending")
```




```{r word cloud}

newscorpus_des<- corpus(data10$`description P`,
                    docnames=data10$video_id,
                    docvar=data.frame(pos=data10$publish_time,
                                      date=data10$first_trending,
                                      loc = data10$views))

newscorpus_tag<- corpus(data10$`tags P`,
                    docnames=data10$video_id,
                    docvar=data.frame(pos=data10$publish_time,
                                      date=data10$first_trending,
                                      loc = data10$views))

newscorpus_title<- corpus(data10$`title P`,
                    docnames=data10$video_id,
                    docvar=data.frame(pos=data10$publish_time,
                                      date=data10$first_trending,
                                      loc = data10$views))



```



```{r}
newscorpus<-newscorpus_des

dfm.simple<- dfm(newscorpus, 
               remove = c(stopwords("english")), 
               verbose=F, 
               stem=F)
topfeatures(dfm.simple, n=50)

swlist = c(",", ":",".", "â", "€","-","!","™","¢",")","(","/","_","\"","s","º","\'","|","&","»","ë","ì","t","can","˜","¸","+","ð","ðÿ","¶","¡","linebreak","„","âž","°")
dfm.stem<- dfm(newscorpus, 
               remove = c(swlist,stopwords("english")), 
               verbose=F, 
               stem=F)
topfeatures(dfm.stem, n=50)


set.seed(333)   #keeps cloud' shape fixed
freq<-topfeatures(dfm.stem, n=500)

wordcloud(names(freq), 
          freq, max.words=100, 
          scale=c(3, .3), 
          colors=brewer.pal(8, "Dark2"))
```


```{r}
newscorpus<-newscorpus_tag

dfm.simple<- dfm(newscorpus, 
               remove = c(stopwords("english")), 
               verbose=F, 
               stem=F)
topfeatures(dfm.simple, n=50)

swlist = c("‚", ":",".", "à", "€","-","!","¤","¢",")","(","/","_","\"","s","?","º","\'","|","&","»","ë","ì","t","can","˜","¸","+","¥","=","¶","¡","linebreak","„","âž","°")
dfm.stem<- dfm(newscorpus, 
               remove = c(swlist,stopwords("english")), 
               verbose=F, 
               stem=F)
topfeatures(dfm.stem, n=50)


set.seed(142)   #keeps cloud' shape fixed
freq<-topfeatures(dfm.stem, n=500)

wordcloud(names(freq), 
          freq, max.words=120, 
          scale=c(3, .3), 
          colors=brewer.pal(8, "Dark2"))
```


```{r}
newscorpus<-newscorpus_title

dfm.simple<- dfm(newscorpus, 
               remove = c(stopwords("english")), 
               verbose=F, 
               stem=F)
topfeatures(dfm.simple, n=50)

swlist = c(",", ":",".", "à", "€","-","!","¤","¢",")","(","/","_","\"","ë","?","º","\'","|","&","[","]","ì","ðÿ","™","˜","¸","+","¥","=","¶","¡","â","„","©","$")
dfm.stem<- dfm(newscorpus, 
               remove = c(swlist,stopwords("english")), 
               verbose=F, 
               stem=F)
topfeatures(dfm.stem, n=50)


set.seed(142)   #keeps cloud' shape fixed
freq<-topfeatures(dfm.stem, n=500)

wordcloud(names(freq), 
          freq, max.words=200, 
          scale=c(3, .3), 
          colors=brewer.pal(8, "Dark2"))
```

```{r cat distribute&top tags}

ggplot(data = data10,aes(category_name))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("category distribution")
swlist = c("‚", ":",".", "à", "€","-","!","¤","¢",")","(","/","_","\"","s","º","\'","|","&","»","ë","ì","t","can","˜","¸","+","¥","=","¶","¡","linebreak","„","âž","°","ð","ñ")
data30<-data.frame(cat_dict)
for(i in 1:nrow(data30)){
#i=2
  #ifelse(i%%100==0,print(paste(i," ",round(i/nrow(data20)*100,2),"%")),0)
  
  temp<-subset(data10,data10$category_name==data30[i,1])
  if(nrow(temp)==0){
    next
  }
  newscorpus_temp<- corpus(temp$`tags P`,docnames=temp$video_id)
  dfm.stem<- dfm(newscorpus_temp, 
               remove = c(swlist,stopwords("english")), 
               verbose=F,stem=F)
  temp_list<-topfeatures(dfm.stem, n=5)
  data30[i,"top_tag"]<-ifelse(temp_list[1]>=1,names(temp_list[1]),NA)
  data30[i,"second_tag"]<-ifelse(length(temp_list>1)&temp_list[2]>=1,names(temp_list[2]),NA)
  data30[i,"third_tag"]<-ifelse(length(temp_list>2)&temp_list[3]>=1,names(temp_list[3]),NA)
  data30[i,"fourth_tag"]<-ifelse(length(temp_list>3)&temp_list[4]>=1,names(temp_list[4]),NA)
}
data30[!is.na(data30$top_tag),]
```


```{r number hist}
#continuos use histogram
#cat without y use bar
#cat with y use col
ggplot(data = data10,aes(trending_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many days a video is trending")
ggplot(data = data10,aes(title_change_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("times a video changed titles")
ggplot(data = data10,aes(tag_change_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("times a video changed tags")
ggplot(data = data10,aes(des_change_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("times a video changed description")
ggplot(data = data10,aes(cat_change_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("times a video changed category")
ggplot(data = data10,aes(chn_change_count))+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("times a video's owner change vhannel title")
ggplot(data = data10,aes(views))+geom_histogram(bins=10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("views distribution")
ggplot(data = data10[data10$views<=15000000,],aes(views))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("views distribution <=15000000")
ggplot(data = data10[data10$views>15000000,],aes(views))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("views distribution >15000000")
ggplot(data = data10[data10$likes<=100000,],aes(likes))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("likes distribution <=100000")
ggplot(data = data10[data10$likes>100000,],aes(likes))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("likes distribution >100000")
ggplot(data = data10[data10$dislikes<=100000,],aes(dislikes))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("dislikes distribution <=100000")
ggplot(data = data10[data10$dislikes>100000,],aes(dislikes))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("dislikes distribution >100000")
ggplot(data = data10[data10$comment_count<=100000,],aes(comment_count))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("comment_count distribution <=100000")
ggplot(data = data10[data10$comment_count>100000,],aes(comment_count))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("comment_count distribution >100000")
ggplot(data = data10,aes(comments_disabled))+geom_bar()+ggtitle("is the video disabled comments")
ggplot(data = data10,aes(ratings_disabled))+geom_bar()+ggtitle("is the video disabled ratings")
ggplot(data = data10,aes(video_error_or_removed))+geom_bar()+ ggtitle("is the video disabled removed")
ggplot(data = data10,aes(des_url_count))+geom_histogram()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many external links in the description")
ggplot(data = data10,aes(trending_span))+geom_histogram()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days between first and last day trending")

ggplot(data = data10,aes(log2(day_until_trending)))+geom_histogram()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days until trending log2")
ggplot(data = data10[data10$day_until_trending<=100,],aes(day_until_trending))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days until trending <=100")
ggplot(data = data10[data10$day_until_trending>100,],aes(day_until_trending))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days until trending >100")

ggplot(data = data10,aes(like_rate))+geom_histogram()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("video like rate distribution")
ggplot(data = data10,aes(like_engage_rate))+geom_histogram()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("percentage of like interaction distribution")
ggplot(data = data10,aes(comment_engage_rate))+geom_histogram()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("percentage of comments interaction distribution")

ggplot(data = data10[data10$view_increment<=1000,],aes(view_increment))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days until trending <=100")
ggplot(data = data10[data10$view_increment>1000,],aes(view_increment))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days until trending >100")

ggplot(data = data10,aes(engagement_score))+geom_histogram(bins=15)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("percentage of comments interaction distribution")+xlim(-2000,10000)



```



```{r youtuber}
#youtuberAG_list<-c("channel_title","min_view","min_likes","min_dislikes","min_comments")
temp_avg<-c("trending_count","title_change_count","tag_change_count","des_change_count","cat_change_count","views","likes","dislikes","comment_count","des_url_count","trending_span","day_until_trending","like_rate","like_engage_rate","comment_engage_rate","engagement_score","view_increment")
temp_max<-c("max_view","max_likes","max_dislikes","max_comments","trending_span","engagement_score","view_increment")
temp_sum<-c("views","comment_count","likes")
temp_top<-c("tags","category_name")

data20<- aggregate(data10$video_id,by=list(data10$channel_title),FUN=length)
colnames(data20)<-c("channel","trend_video_count") 
swlist = c("‚", ":",".", "à", "€","-","!","¤","¢",")","(","/","_","\"","s","º","\'","|","&","»","ë","ì","t","ìš","˜","¸","+","¥","=","¶","¡","¬","„","ãƒ","°","ã",
"[","ð","´")
for(i in 1:nrow(data20)){
#i=2
  ifelse(i%%100==0,print(paste(i," ",round(i/nrow(data20)*100,2),"%")),0)
  
  temp<-subset(data10,data10$channel_title==data20[i,"channel"])
  #temp<-temp[order(temp$trending_date,decreasing = T),]
  for(j in temp_avg){
    data20[i,paste("avg_",j,sep = "")]<-mean(temp[[j]])
  }
  
  for(j in temp_max){
    data20[i,paste("max_",j,sep = "")]<-max(temp[[j]])
  }
  for(j in temp_sum){
    data20[i,paste("sum_",j,sep = "")]<-sum(temp[[j]])
  }
  
  newscorpus_temp<- corpus(temp$`tags P`,docnames=temp$video_id)
  dfm.stem<- dfm(newscorpus_temp, 
               remove = c(swlist,stopwords("english")), 
               verbose=F,stem=F)
  
  temp_list<-topfeatures(dfm.stem, n=2)
  data20[i,"top_tag"]<-ifelse(temp_list[1]>=1,names(temp_list[1]),NA)
  data20[i,"second_tag"]<-ifelse(length(temp_list>1)&temp_list[2]>=1,names(temp_list[2]),NA)
  temp_list<-table(temp$category_name)
  data20[i,"top_cat"]<-names(temp_list[1])
  data20[i,"second_cat"]<-ifelse(length(temp_list>1),names(temp_list[2]),NA)
}

#only 101 have trending in more than 1 cat

```

```{r}
colnames(data20)
```


```{r youtuber plot}
temp<-data20[order(-data20$trend_video_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-trend_video_count),y=trend_video_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many times its video is trending")

temp<-data20[order(-data20$avg_trending_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_trending_count),y=avg_trending_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days its trending video will stay trending(average)")

temp<-data20[order(-data20$avg_title_change_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_title_change_count),y=avg_title_change_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many times the it changed it's trending video title")

temp<-data20[order(-data20$avg_tag_change_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_tag_change_count),y=avg_tag_change_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many times the it changed it's trending video tag")

temp<-data20[order(-data20$avg_des_change_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_des_change_count),y=avg_des_change_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many times the it changed it's trending video description")

temp<-data20[order(-data20$avg_cat_change_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_trending_count),y=avg_cat_change_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many times the it changed it's trending video category")

temp<-data20[order(-data20$avg_views,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_views),y=avg_views))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many view will its trending video get")

temp<-data20[order(-data20$avg_likes,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_views),y=avg_views))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many likes will its trending video get")

temp<-data20[order(-data20$avg_dislikes,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_views),y=avg_views))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many dislikes will its trending video get")

temp<-data20[order(-data20$avg_comment_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_comment_count),y=avg_comment_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many comments will its trending video get")

temp<-data20[order(-data20$avg_des_url_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_des_url_count),y=avg_des_url_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many URL will its trending video have in the description")

temp<-data20[order(-data20$avg_trending_span,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_trending_span),y=avg_trending_span))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many days will its trending video can last")

temp<-data20[order(-data20$avg_day_until_trending,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_day_until_trending),y=avg_day_until_trending))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many days will its trending video need to become trending(average)")

temp<-data20[order(-data20$avg_like_rate,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_like_rate),y=avg_like_rate))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many viewers likes its trending video (average)")

temp<-data20[order(-data20$avg_like_engage_rate,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_like_engage_rate),y=avg_like_engage_rate))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many viewer will click its trending video's like / dislike")

temp<-data20[order(-data20$avg_comment_engage_rate,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_comment_engage_rate),y=avg_comment_engage_rate))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("How many viewer will leave comments on its trending video")

temp<-data20[order(-data20$max_max_view,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-max_max_view),y=max_max_view))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("channnel")

temp<-data20[order(-data20$max_max_likes,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-max_max_likes),y=max_max_likes))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many likes this youtuber ever have on single trending video")

temp<-data20[order(-data20$max_max_dislikes,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-max_max_dislikes),y=max_max_dislikes))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many dislikes this youtuber ever have on single trending video")

temp<-data20[order(-data20$max_max_comments,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-max_max_comments),y=max_max_comments))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many comments this youtuber ever have on single trending video")

temp<-data20[order(-data20$max_trending_span,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-max_trending_span),y=max_trending_span))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many days its long lasting video stay trending")

temp<-data20[order(-data20$sum_views,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-sum_views),y=sum_views))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many view this youtuber have for all its trending video")

temp<-data20[order(-data20$sum_comment_count,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-sum_comment_count),y=sum_comment_count))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many comments this youtuber have for all its trending video")

temp<-data20[order(-data20$sum_likes,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-sum_likes),y=sum_likes))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("how many likes this youtuber have for all its trending video")

temp<-aggregate(data20$top_tag,by=list(data20$top_tag),FUN=length)
temp<-temp[order(-temp$x,decreasing = F),]
ggplot(data = temp[1:30,],mapping = aes(x=reorder(Group.1,-x),y=x))+geom_col()+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+ggtitle("most common tags among youtubers")

temp<-aggregate(data20$top_cat,by=list(data20$top_cat),FUN=length)
temp<-temp[order(-temp$x,decreasing = F),]
ggplot(data = temp[1:16,],mapping = aes(x=reorder(Group.1,-x),y=x))+geom_col()+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+ggtitle("most common category among youtubers")

temp<-data20[order(-data20$avg_engagement_score,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-avg_engagement_score),y=avg_engagement_score))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("top youtubers with highest average engagement score")
temp<-data20[order(-data20$max_engagement_score,decreasing = F),]
ggplot(data = temp[1:50,],mapping = aes(x=reorder(channel,-max_engagement_score),y=max_engagement_score))+geom_col()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+ggtitle("top youtubers with highest singel video engagement score")
```











